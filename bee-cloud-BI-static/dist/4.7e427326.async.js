(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{GZCc:function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var c=r(a("qIgq")),n=r(a("d6i3")),o=r(a("p0pE")),u=a("3eXy"),s=a("pxNB"),d={namespace:"purchaseWarehousingModel",state:{saveFreeStorageParams:{},storageOptions:[],productsOptions:[],productSpecOptions:[],detailDataWithAdd:[],detailData:{}},effects:{cacheSaveFreeStorageEffect:n["default"].mark(function e(t,a){var r,c,u,s;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.payload,c=t.callback,a.call,u=a.put,s=r.productId,!s){e.next=10;break}return e.next=6,u({type:"getProductSpecByProductIdEffect",payload:s,callback:c});case 6:return e.next=8,u({type:"cacheSaveFreeStorage",payload:(0,o["default"])({},r,{productSpecId:""})});case 8:e.next=12;break;case 10:return e.next=12,u({type:"cacheSaveFreeStorage",payload:r});case 12:case"end":return e.stop()}},e)}),saveFreeStorageEffect:n["default"].mark(function e(t,a){var r,c,u,d,l,p,i,f,g;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.payload,r=t.callback,c=a.call,u=a.put,d=a.select,e.next=4,d(function(e){return e.purchaseWarehousingModel});case 4:return l=e.sent,p=l.saveFreeStorageParams,i=l.productSpecOptions,f=(0,o["default"])({},p,{productSpecName:i.filter(function(e){return e.value===p.productSpecId})[0].label}),e.next=10,c(s.saveFreeStorageService,f);case 10:if(g=e.sent,!g||1!==g.code){e.next=17;break}return r("","ok","\u65b0\u589e\u6210\u529f"),e.next=15,u({type:"cacheSaveFreeStorageEffect",payload:{storageId:"",productId:"",productSpecId:"",productNumber:""}});case 15:e.next=18;break;case 17:r("","error",g.message);case 18:case"end":return e.stop()}},e)}),getFreeStorageEffect:n["default"].mark(function e(t,a){var r,c,o,u,d;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,c=t.callback,o=a.call,u=a.put,e.next=4,o(s.getFreeStorageService,r);case 4:if(d=e.sent,!d||1!==d.code){e.next=11;break}return e.next=8,u({type:"getFreeStorageReduce",payload:d.object});case 8:c("","ok",""),e.next=12;break;case 11:c("","error",d.message);case 12:case"end":return e.stop()}},e)}),getDetailEffect:n["default"].mark(function e(t,a){var r,c,o,u,d,l,p,i;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,c=t.callback,o=a.call,u=a.put,d=a.select,e.next=4,d(function(e){return e.purchaseWarehousingModel});case 4:if(l=e.sent,p=l.storageOptions,0!==p.length){e.next=9;break}return e.next=9,u({type:"fetchInitOptionsEffect",payload:{},callback:c});case 9:return e.next=11,o(s.getDetailService,r);case 11:if(i=e.sent,!i||1!==i.code){e.next=17;break}return e.next=15,u({type:"getDetailReduce",payload:i.object});case 15:e.next=18;break;case 17:c("","error",i.message);case 18:case"end":return e.stop()}},e)}),saveProductEffect:n["default"].mark(function e(t,a){var r,c,o,u;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,c=t.callback,o=a.call,a.put,a.select,e.next=4,o(s.saveProductService,r);case 4:u=e.sent,u&&1===u.code?c("","ok","\u63d0\u4ea4\u6210\u529f"):c("","error",u.message);case 6:case"end":return e.stop()}},e)}),fetchInitOptionsEffect:n["default"].mark(function e(t,a){var r,s,d,l,p,i,f,g,v,b,x,y;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.payload,r=t.callback,s=a.call,d=a.all,l=a.put,e.next=4,d([s(u.getRepositoryListByType,{rq:{types:[]}}),s(u.getProducts,{})]);case 4:if(p=e.sent,i=(0,c["default"])(p,2),f=i[0],g=i[1],!f||!g){e.next=23;break}if(1!==f.code||1!==g.code){e.next=19;break}return{value:"0",label:"\u5168\u90e8"},v=f.object.map(function(e){return{value:"".concat(e.id),label:e.name,origin:e}}),b=g.object.map(function(e){return{value:"".concat(e.productId),label:e.productName,origin:e}}),x={storageOptions:v,productsOptions:b},e.next=16,l({type:"fetchInitOptionsReduce",payload:(0,o["default"])({},x)});case 16:r(x,"ok",""),e.next=21;break;case 19:y=f.message||g.message||"fetchInit-error",r("","error",y);case 21:e.next=24;break;case 23:r("","error","fetchInit-error");case 24:case"end":return e.stop()}},e)}),getProductSpecByProductIdEffect:n["default"].mark(function e(t,a){var r,c,o,s,d,l;return n["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,c=t.callback,o=a.call,s=a.put,a.select,e.next=4,o(u.getProductSpecByProductId,r);case 4:if(d=e.sent,l=[],!d||1!==d.code){e.next=13;break}if(!(d.object.length>0)){e.next=11;break}return l=d.object.map(function(e){return{value:"".concat(e.id),label:e.specName,origin:e}}),e.next=11,s({type:"getProductSpecByProductIdReduce",payload:l});case 11:e.next=14;break;case 13:c&&c("","error",d.message);case 14:case"end":return e.stop()}},e)})},reducers:{cacheSaveFreeStorage:function(e,t){var a=t.payload;return(0,o["default"])({},e,{saveFreeStorageParams:(0,o["default"])({},e.saveFreeStorageParams,a)})},getFreeStorageReduce:function(e,t){var a=t.payload;return(0,o["default"])({},e,{detailDataWithAdd:a})},getDetailReduce:function(e,t){var a=t.payload;return(0,o["default"])({},e,{detailData:a})},fetchInitOptionsReduce:function(e,t){var a=t.payload;return(0,o["default"])({},e,{storageOptions:a.storageOptions,productsOptions:a.productsOptions})},getProductSpecByProductIdReduce:function(e,t){var a=t.payload;return(0,o["default"])({},e,{productSpecOptions:a})}}};t["default"]=d}}]);