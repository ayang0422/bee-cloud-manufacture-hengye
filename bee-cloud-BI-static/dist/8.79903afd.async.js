(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{ituF:function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var o=r(a("gWZ8")),n=r(a("qIgq")),s=r(a("d6i3")),c=r(a("p0pE")),u=r(a("wd/R")),p=a("LvDl"),l=a("mWaa"),i=a("3eXy"),d=a("qj0U"),f=a("cNkv"),m=l.reportType.existingDeatil.key,y=l.reportType.existingDeatil.businessType,b={namespace:"ReportFormCommonModel",state:{parentTabs:[],productsOptions:[],storageOptions:[],productsCateOptions:[],furnaceOptions:[],shiftCodeOptions:[],columnsParams:{reportType:m,businessType:y,productId:""},columnsObj:{1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[],11:[],12:[],13:[],14:[],15:[]},listSearchParams:{reportType:m,currentPage:1,orderStage:"",pageSize:10,searchCount:!0,dateRange:{startTime:(0,u["default"])().subtract(30,"days").format("YYYY-MM-DD"),endTime:(0,u["default"])().format("YYYY-MM-DD")},dayTime:(0,u["default"])().format("YYYY-MM-DD"),productId:"",storageId:"",sampleCode:"",categoryId:"0",year:"2019"},dataObj:{}},effects:{getTabPagesEffect:s["default"].mark(function e(t,a){var r,o,n,u,p,d,f,m;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,o=t.callback,n=a.call,u=a.put,p=r.type,d=r.columnsParams,e.next=5,n(i.getEnableReportFormsList,{type:p});case 5:if(f=e.sent,!(f&&1===f.code&&Array.isArray(f.object)&&f.object.length>0)){e.next=15;break}return m=[],f.object.forEach(function(e){l.tabPages[Number(e.code)]&&m.push((0,c["default"])({},l.tabPages[Number(e.code)],{containerL:null}))}),e.next=11,u({type:"getTabPagesReduce",payload:m});case 11:return e.next=13,u({type:"fetchInitOptionsEffect",payload:{columnsParams:d},callback:o});case 13:e.next=16;break;case 15:o("","error",f.message);case 16:case"end":return e.stop()}},e)}),fetchInitOptionsEffect:s["default"].mark(function e(t,a){var r,o,u,p,l,i,f,m,y,b,g,h,k,x,P,O,v,R,T,S;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,o=t.callback,u=a.call,p=a.all,l=a.put,e.next=4,p([u(d.getRepositoryListByType,{rq:{types:[]}}),u(d.getProducts,{}),u(d.getProductCategories,{})]);case 4:if(i=e.sent,f=(0,n["default"])(i,3),m=f[0],y=f[1],b=f[2],!(m&&y&&b)){e.next=34;break}if(1!==m.code||1!==y.code||1!==b.code){e.next=30;break}return g={value:"0",label:"\u5168\u90e8"},h=m.object.map(function(e){return{value:"".concat(e.id),label:e.name,origin:e}}),h.unshift(g),k=y.object.map(function(e){return{value:"".concat(e.productId),label:e.productName,origin:e}}),x=b.object.map(function(e){return{value:"".concat(e.categoryId),label:e.categoryName,origin:e}}),x.unshift(g),P={storageOptions:h,productsOptions:k,productsCateOptions:x},e.next=20,l({type:"fetchInitOptionsReduce",payload:(0,c["default"])({},P)});case 20:if(!r||!r.columnsParams){e.next=27;break}return O=k[0].value,v=h[0].value,R=x[0].value,T=(0,c["default"])({},r.columnsParams,{productId:O}),e.next=27,l({type:"fetchColumnsNameEffect",payload:{columnsParams:T,listSearchParams:{productId:O,storageId:v,categoryId:R,reportType:T.reportType}},callback:o});case 27:o(P,"ok",""),e.next=32;break;case 30:S=m.message||y.message||b.message||"fetchInit-error",o("","error",S);case 32:e.next=35;break;case 34:o("","error","fetchInit-error");case 35:case"end":return e.stop()}},e)}),fetchColumnsNameEffect:s["default"].mark(function e(t,a){var r,n,u,p,l,i,f,m,y,b,g,h,k,x,P,O,v,R,T;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.payload,n=t.callback,u=a.call,p=a.put,l=a.select,!r||"{}"===JSON.stringify(r)){e.next=27;break}return i=r.columnsParams,f=void 0===i?{}:i,m=r.listSearchParams,y=void 0===m?{}:m,e.next=6,l(function(e){return e.ReportFormCommonModel});case 6:return b=e.sent,g=b.columnsObj,h=b.columnsParams,k=b.listSearchParams,x=(0,c["default"])({},h,f),e.next=13,u(d.getReportFormFields,x);case 13:if(P=e.sent,!P||1!==P.code){e.next=26;break}return O=P.object.fieldsFixed.map(function(e){return{title:e.title,dataIndex:e.dataIndex||e.title}}),Array.isArray(P.object.assayItem)&&P.object.assayItem.length>0&&(v=P.object.assayItem.map(function(e){return{title:e.item,dataIndex:e.item}}),O.push.apply(O,(0,o["default"])(v))),g[x.reportType]=O,e.next=20,p({type:"fetchColumnsNameReduce",payload:{columnsParams:x,columnsObj:g}});case 20:return R=(0,c["default"])({},k,y),e.next=23,p({type:"getListEffect",payload:(0,c["default"])({},R),callback:n});case 23:n&&n("","ok",""),e.next=27;break;case 26:n&&(T=P&&P.message||"fetchInit-error",n("","error",T));case 27:case"end":return e.stop()}},e)}),getListEffect:s["default"].mark(function e(t,a){var r,o,n,u,i,m,y,b,g,h,k,x,P,O,v,R,T,S,I;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=t.payload,o=t.callback,n=a.call,u=a.put,i=a.select,m=null,e.t0=r.reportType,e.next=e.t0===l.reportType.existingDeatil.key?6:e.t0===l.reportType.buySendStorage.key?8:e.t0===l.reportType.productOutStorage.key?10:e.t0===l.reportType.rawMaterial.key?12:e.t0===l.reportType.productWarehouse.key?14:e.t0===l.reportType.productQualiInspect.key?16:e.t0===l.reportType.entryExitQualiInspect.key?16:e.t0===l.reportType.logisticsBuy.key?18:e.t0===l.reportType.logisticsSale.key?20:e.t0===l.reportType.purchase.key?22:e.t0===l.reportType.sales.key?24:e.t0===l.reportType.passRate.key?26:28;break;case 6:return m=d.getExistingDeatilsReportForm,e.abrupt("break",29);case 8:return m=d.getBuySendStorageReportForm,e.abrupt("break",29);case 10:return m=d.getProductOutStorageReportForm,e.abrupt("break",29);case 12:return m=d.getRawMaterialReportForm,e.abrupt("break",29);case 14:return m=d.getProductWarehouseReportForm,e.abrupt("break",29);case 16:return m=d.getQualityTestReportForm,e.abrupt("break",29);case 18:return m=d.getBuyLogisticsReportForm,e.abrupt("break",29);case 20:return m=d.getSaleLogisticsReportForm,e.abrupt("break",29);case 22:return m=d.getBuyReportForm,e.abrupt("break",29);case 24:return m=d.getSaleReportForm,e.abrupt("break",29);case 26:return m=d.getPassRateReportForm,e.abrupt("break",29);case 28:return e.abrupt("break",29);case 29:return e.next=31,i(function(e){return e.ReportFormCommonModel});case 31:if(y=e.sent,b=y.listSearchParams,g=(0,f.dealListParams)({preParams:(0,c["default"])({},b),curParams:r}),h=g.requestParams,k=g.listSearchParams,!m){e.next=59;break}return e.next=37,n(m,h);case 37:return x=e.sent,e.next=40,i(function(e){return e.ReportFormCommonModel});case 40:return P=e.sent,O=P.dataObj,e.next=44,i(function(e){return e.ReportFormCommonModel});case 44:if(v=e.sent,R=v.columnsObj,T={originData:x,columns:R[r.reportType]},S=(0,f.dealListData)(T),I=(0,p.cloneDeep)(O),I[r.reportType]=S,"string"===typeof S){e.next=55;break}return e.next=53,u({type:"getListReduce",payload:{listSearchParams:(0,c["default"])({},k),dataObj:I}});case 53:e.next=59;break;case 55:return o("","error",S),I[r.reportType]={list:[],pagination:{}},e.next=59,u({type:"getListReduce",payload:{listSearchParams:(0,c["default"])({},k),dataObj:I}});case 59:case"end":return e.stop()}},e)}),fetchFurnacesShiftCodeEffect:s["default"].mark(function e(t,a){var r,o,u,p,l,i,f,m,y,b,g,h,k,x,P,O,v,R;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,o=t.callback,u=a.call,p=a.put,l=a.all,e.next=4,l([u(d.getFurnaces,{}),u(d.listConfigCodeByType,{type:"shifts"}),u(d.getProducts,{})]);case 4:if(i=e.sent,f=(0,n["default"])(i,3),m=f[0],y=f[1],b=f[2],!(m&&y&&b)){e.next=32;break}if(1!==m.code||1!==y.code||1!==b.code){e.next=28;break}return g={value:"0",label:"\u5168\u90e8"},h=m.object.map(function(e){return{value:"".concat(e.furnacesId),label:e.furnacesName,origin:e}}),h.unshift(g),k=y.object.map(function(e){return{value:"".concat(e.code),label:e.value,origin:e}}),k.unshift(g),x=b.object.map(function(e){return{value:"".concat(e.productId),label:e.productName,origin:e}}),P={furnaceOptions:h,shiftCodeOptions:k,productsOptions:x},e.next=20,p({type:"fetchFurnacesShiftCodeReduce",payload:(0,c["default"])({},P)});case 20:if(!r||!r.columnsParams){e.next=25;break}return O=x[0].value,v=(0,c["default"])({},r.columnsParams,{productId:O}),e.next=25,p({type:"fetchColumnsNameEffect",payload:v,callback:o});case 25:o(P,"ok",""),e.next=30;break;case 28:R=m.message||y.message||"fetchFurnacesShiftCodeEffect-error",o("","error",R);case 30:e.next=33;break;case 32:o("","error","fetchFurnacesShiftCodeEffect-error");case 33:case"end":return e.stop()}},e)}),cacheSearchParamsEffect:s["default"].mark(function e(t,a){var r,o;return s["default"].wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,o=a.put,e.next=4,o({type:"cacheSearchParamsReduce",payload:r});case 4:case"end":return e.stop()}},e)})},reducers:{getTabPagesReduce:function(e,t){var a=t.payload;return(0,c["default"])({},e,{parentTabs:a})},fetchInitOptionsReduce:function(e,t){var a=t.payload,r=a.storageOptions,o=a.productsOptions,n=a.productsCateOptions;return(0,c["default"])({},e,{storageOptions:r,productsOptions:o,productsCateOptions:n})},fetchColumnsNameReduce:function(e,t){var a=t.payload,r=a.columnsParams,o=a.columnsObj;return(0,c["default"])({},e,{columnsParams:r,columnsObj:o})},getListReduce:function(e,t){var a=t.payload,r=a.listSearchParams,o=a.dataObj;return(0,c["default"])({},e,{listSearchParams:r,dataObj:o})},cacheSearchParamsReduce:function(e,t){var a=t.payload;return(0,c["default"])({},e,{listSearchParams:(0,c["default"])({},e,a)})},fetchFurnacesShiftCodeReduce:function(e,t){var a=t.payload,r=a.furnaceOptions,o=a.productsOptions,n=a.shiftCodeOptions;return(0,c["default"])({},e,{furnaceOptions:r,shiftCodeOptions:n,productsOptions:o})}}};t["default"]=b}}]);